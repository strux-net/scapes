# Autogenerated makefile
# by :
#   m_tru mTR >makefile
#
m_diff=bash -c 'if ! diff -a -q $$1 ok/$$1 >/dev/null ; then echo -e "BAD\t$$1\tok/$$1" ; else echo -e "GOOD\t$$1" ; fi ; ' m_diff
m_copy=bash -c 'if ! diff -a -q $$1 $$2    >/dev/null ; then echo copying $$1 $$2; cp -p $$1 $$2 ; fi ; ' m_copy
ALL:\
  LL.vim\
  disp.vim\

install install_ALL:\
  install_LL.vim\
  install_disp.vim\

test test_ALL:\
  test_LL.vim\
  test_disp.vim\

logged_build:
	-@${MAKE} --no-print-directory test_ALL 2>&1 | perl -pe 's,$$ENV{HOME}/,~/,g' >m.log # substitute /home/username with ~  (to avoid test-fails for trivial reasons)
	@${m_diff} m.log
confirmed_install: confirm install
confirm:
	@bash -c 'read -p "really install ? (^C) if not"'
export Title=A vim/perl based filebrowser with nice features
install_LL.vim:
	@echo  installing LL.vim
	@${m_copy} LL.vim ok/LL.vim
	@${m_copy} LL.vim ~/.vim/plugin
	@${m_copy} docs/LL-commands.txt ~/.vim/doc/
	@${m_copy} docs/LL.txt          ~/.vim/doc/
	@${m_copy} docs/LL-commands.txt ok/docs/LL-commands.txt
	vim -u NONE -c 'helptags ~/.vim/doc' -c q
	@${m_copy} docs/LL.txt ok/docs/LL.txt
	@${m_copy} docs/README.html ok/docs/README.html
test_LL.vim: LL.vim
	@echo  testing LL.vim
.PHONY: LL.vim
LL.vim:
	@echo  building LL.vim
	vim_tru LL.vimTR >LL.vim
	@${m_diff} LL.vim
	Title="*LL.txt*   A vim/perl based filebrowser with nice features" vimInterface2Help_tru LL.vimTR >docs/LL-commands.txt
	@${m_diff} docs/LL-commands.txt
	perl -i -ne 'BEGIN{ $$s="A quick overview follows"; $$e="==============================================================================" } if (/^$$s/../$$e/ ) { unless ($$d++) { print "$$s\n" ; print `vimInterface2Help_terse_tru LL.vimTR`; print "\n$$e\n" }} else { print }' docs/LL.txt
	@${m_diff} docs/LL.txt
	html_tru docs/README.txtTR >docs/README.html
	@${m_diff} docs/README.html
install_disp.vim:
	@echo  installing disp.vim
	@${m_copy} disp.vim ok/disp.vim
	@${m_copy} disp.vim ~/.vim/plugin
test_disp.vim: disp.vim
	@echo  testing disp.vim
.PHONY: disp.vim
disp.vim:
	@echo  building disp.vim
	vim_tru disp.vimTR >disp.vim
	@${m_diff} disp.vim

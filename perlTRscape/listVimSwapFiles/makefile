# Autogenerated makefile
# by :
#   m_tru mTR >makefile
#
m_diff=bash -c 'if ! diff -a -q $$1 ok/$$1 >/dev/null ; then echo -e "BAD\t$$1\tok/$$1" ; else echo -e "GOOD\t$$1" ; fi ; ' m_diff
m_copy=bash -c 'if ! diff -a -q $$1 $$2    >/dev/null ; then echo copying $$1 $$2; cp -p $$1 $$2 ; fi ; ' m_copy
ALL:\
  listVimSwapFiles\

install install_ALL:\
  install_listVimSwapFiles\

test test_ALL:\
  test_listVimSwapFiles\

logged_build:
	-@${MAKE} --no-print-directory test_ALL 2>&1 | perl -pe 's,$$ENV{HOME}/,~/,g' >m.log # substitute /home/username with ~  (to avoid test-fails for trivial reasons)
	@${m_diff} m.log
confirmed_install: confirm install
confirm:
	@bash -c 'read -p "really install ? (^C) if not"'
export Title=parses output of `vim -r` and presents it compacted 
install_listVimSwapFiles:
	@echo  installing listVimSwapFiles
	@${m_copy} listVimSwapFiles ok/listVimSwapFiles
	@${m_copy} listVimSwapFiles.vim ok/listVimSwapFiles.vim
	@${m_copy} docs/README.txt ok/docs/README.txt
	@${m_copy} docs/README.html ok/docs/README.html
	@${m_copy} listVimSwapFiles ~/strux/bin/listVimSwapFiles
	@${m_copy} listVimSwapFiles.vim ~/.vim/plugin/
test_listVimSwapFiles: listVimSwapFiles
	@echo  testing listVimSwapFiles
.PHONY: listVimSwapFiles
listVimSwapFiles:
	@echo  building listVimSwapFiles
	perl_tru listVimSwapFiles.plTR >listVimSwapFiles
	@${m_diff} listVimSwapFiles
	chmod +x listVimSwapFiles
	perl_tru -vimPlug listVimSwapFiles.plTR >listVimSwapFiles.vim
	@${m_diff} listVimSwapFiles.vim
	touch docs/README.txt;rm docs/README.txt # I want the tests to pass
	echo "listVimSwapFiles\n  as a perlscript\n    code" >> docs/README.txt
	./listVimSwapFiles -? 2>&1 | i -it 1                 >> docs/README.txt
	echo "  as a vim-plugin\n    code"                   >> docs/README.txt
	isel -f 1 -nh README listVimSwapFiles.plTR | i -i 6  >> docs/README.txt
	@${m_diff} docs/README.txt
	html_tru docs/README.txt >docs/README.html
	@${m_diff} docs/README.html
